

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Step 3: Running NAIF PDS4 Bundler &mdash; NAIF PDS4 Bundler 1.8.0
 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/theme_overrides.css?v=8a44a683" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=b51e6972"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Step 4: Checking the Result and Finishing Up" href="34_step_4_checking_the_result.html" />
    <link rel="prev" title="Step 2: Preparing the NAIF PDS4 Bundler Setup" href="32_step_2_npb_setup.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            NAIF PDS4 Bundler
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="10_overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="20_spice_kernel_archive_description.html">SPICE Kernel Archive Description</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="30_spice_kernel_archive_preparation_guide.html">SPICE Kernel Archive Preparation Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="31_step_1_preparing_data.html">Step 1: Preparing Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="32_step_2_npb_setup.html">Step 2: Preparing the NAIF PDS4 Bundler Setup</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Step 3: Running NAIF PDS4 Bundler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#run-npb-from-the-command-line">Run NPB from the command line</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interactive-step-for-meta-kernels">Interactive step for Meta-kernels</a></li>
<li class="toctree-l3"><a class="reference internal" href="#understanding-npb-prompting-and-logging">Understanding NPB prompting and logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-if-something-goes-wrong">What if something goes wrong?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#processing-large-binary-kernels">Processing large binary kernels</a></li>
<li class="toctree-l3"><a class="reference internal" href="#until-you-get-it-right">Until you get it right</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="34_step_4_checking_the_result.html">Step 4: Checking the Result and Finishing Up</a></li>
<li class="toctree-l2"><a class="reference internal" href="35_step_5_packaging_to_naif.html">Step 5: Packaging and Delivering the Archive to the NAIF Node</a></li>
<li class="toctree-l2"><a class="reference internal" href="36_step_by_step_summary.html">Step-by-Step Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="40_naif_pds4_bundler_user_guide.html">NAIF PDS4 Bundler User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="50_api_docs.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="60_annex_npb_for_pds3.html">Appendix: NPB for PDS3 Archives</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NAIF PDS4 Bundler</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="30_spice_kernel_archive_preparation_guide.html">SPICE Kernel Archive Preparation Guide</a></li>
      <li class="breadcrumb-item active">Step 3: Running NAIF PDS4 Bundler</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/33_step_3_running_npb.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="step-3-running-naif-pds4-bundler">
<h1>Step 3: Running NAIF PDS4 Bundler<a class="headerlink" href="#step-3-running-naif-pds4-bundler" title="Link to this heading"></a></h1>
<p>Once you have reached this step, the hard work is done. From here onwards the
process should take full advantage of NPB and should be mostly automatic.</p>
<section id="run-npb-from-the-command-line">
<h2>Run NPB from the command line<a class="headerlink" href="#run-npb-from-the-command-line" title="Link to this heading"></a></h2>
<p>If you are in a hurry run NPB as follows: open your favorite terminal
application and with coherence to the workspace that you have defined
for NPB, execute the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ naif-pds4-bundler &lt;path_to_file&gt;/&lt;sc&gt;_release_??.xml -p &lt;path_to_file&gt;/&lt;sc&gt;_release_??.plan -l -v
</pre></div>
</div>
<p>where</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;path_to_file&gt;</span></code> is the relative or absolute path to the corresponding
file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;sc&gt;</span></code> is the mission acronym</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">??</span></code> is the two digit archive release version</p></li>
</ul>
</div></blockquote>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ naif-pds4-bundler maven_release_26.xml -p maven_release_26.plan -l -v
</pre></div>
</div>
<p>This will run NPB using the configuration file that you have just written or
updated for the files specified in the archive release plan (<code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">PLAN</span></code>), will
generate a log file with the following file name: <code class="docutils literal notranslate"><span class="pre">&lt;sc&gt;_release_??.log</span></code>
(<code class="docutils literal notranslate"><span class="pre">-l</span></code>) and will run with verbosity (<code class="docutils literal notranslate"><span class="pre">-v</span></code>). This is the recommended
way to run NPB, but is not the only one. Explanations for all the options to run
NPB are provided in Section
<a class="reference internal" href="43_using_npb.html#running-npb-from-the-command-line"><span class="std std-ref">Running NPB from the command line</span></a>.</p>
<p>We recommend you to always generate a log of your run (<code class="docutils literal notranslate"><span class="pre">-l</span></code>) and in general,
and especially for the first times that you use NPB, we recommend you to prompt
the log in the screen as well (<code class="docutils literal notranslate"><span class="pre">-v</span></code>). If it is the first time you are using
the configuration file, it might be a good idea to test the generation of the
kernel list (<code class="docutils literal notranslate"><span class="pre">-f</span> <span class="pre">list</span></code>) and then to inspect the release products in the
staging area before pushing them to the bundle area (<code class="docutils literal notranslate"><span class="pre">-f</span> <span class="pre">staging</span></code>).</p>
<p>We <strong>do not</strong> recommend you to bypass the final validation (<code class="docutils literal notranslate"><span class="pre">-f</span> <span class="pre">bundle</span></code>),
to use a kernel list as your input (instead of a release plan with
<code class="docutils literal notranslate"><span class="pre">-kerlist</span> <span class="pre">KERLIST</span></code>) or to run NPB silently (<code class="docutils literal notranslate"><span class="pre">-s</span></code>), unless you are
experienced with its usage and you have a strong reason to do so.</p>
</section>
<section id="interactive-step-for-meta-kernels">
<h2>Interactive step for Meta-kernels<a class="headerlink" href="#interactive-step-for-meta-kernels" title="Link to this heading"></a></h2>
<p>If the Meta-kernel(s) are being generated automatically, which means that
you have provided a a <code class="docutils literal notranslate"><span class="pre">&lt;mk&gt;</span></code> section in the configuration file and that you
have set the nested element <code class="docutils literal notranslate"><span class="pre">&lt;interrupt_to_update&gt;</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>, NPB will pause
its execution for each generated MK, before the MK is labelled and will give you
the opportunity to edit the MK at your will. NPB will either let you use
a text editor of your choice or it can also try to run <code class="docutils literal notranslate"><span class="pre">vi</span></code> for you. The
message that you will see is similar to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INFO</span>    <span class="p">:</span> <span class="o">--</span> <span class="n">Meta</span><span class="o">-</span><span class="n">kernel</span> <span class="n">generated</span><span class="o">.</span>
    <span class="o">*</span> <span class="n">The</span> <span class="n">meta</span><span class="o">-</span><span class="n">kernel</span> <span class="n">might</span> <span class="n">need</span> <span class="n">to</span> <span class="n">be</span> <span class="n">updated</span><span class="o">.</span> <span class="n">You</span> <span class="n">can</span><span class="p">:</span>
        <span class="o">-</span> <span class="n">Type</span> <span class="s2">&quot;vi&quot;</span> <span class="ow">and</span> <span class="n">press</span> <span class="n">ENTER</span> <span class="n">to</span> <span class="n">edit</span> <span class="n">the</span> <span class="n">file</span> <span class="k">with</span> <span class="n">the</span> <span class="n">VI</span> <span class="n">text</span> <span class="n">editor</span><span class="o">.</span>
        <span class="o">-</span> <span class="n">Edit</span> <span class="n">the</span> <span class="n">file</span> <span class="k">with</span> <span class="n">your</span> <span class="n">favorite</span> <span class="n">edit</span> <span class="ow">and</span> <span class="n">press</span> <span class="n">ENTER</span> <span class="ow">and</span> <span class="k">continue</span><span class="o">.</span>
        <span class="o">-</span> <span class="n">Press</span> <span class="n">ENTER</span> <span class="n">to</span> <span class="k">continue</span><span class="o">.</span>
      <span class="n">MK</span> <span class="n">path</span><span class="p">:</span> <span class="o">/</span><span class="n">staging</span><span class="o">/</span><span class="n">insight_spice</span><span class="o">/</span><span class="n">spice_kernels</span><span class="o">/</span><span class="n">mk</span><span class="o">/</span><span class="n">insight_v08</span><span class="o">.</span><span class="n">tm</span>
<span class="o">&gt;&gt;</span> <span class="n">Type</span> <span class="s1">&#39;vi&#39;</span> <span class="ow">and</span><span class="o">/</span><span class="ow">or</span> <span class="n">press</span> <span class="n">ENTER</span> <span class="n">to</span> <span class="k">continue</span><span class="o">...</span>
</pre></div>
</div>
<p>More information is provided in <a class="reference internal" href="31_step_1_preparing_data.html#preparing-meta-kernels"><span class="std std-ref">Preparing Meta-kernels</span></a>
and <a class="reference internal" href="42_npb_configuration_file.html#meta-kernel"><span class="std std-ref">Meta-kernel</span></a>.</p>
</section>
<section id="understanding-npb-prompting-and-logging">
<h2>Understanding NPB prompting and logging<a class="headerlink" href="#understanding-npb-prompting-and-logging" title="Link to this heading"></a></h2>
<p>We have recommended you to run NPB in verbose mode (<code class="docutils literal notranslate"><span class="pre">-v</span> <span class="pre">--verbose</span></code>) and to
generate the run log (<code class="docutils literal notranslate"><span class="pre">-l</span> <span class="pre">--log</span></code>). If you do so, NPB will provide you either
on the screen or in the log a structured and comprehensive step-by-step
explanation of the run with <code class="docutils literal notranslate"><span class="pre">INFO</span></code>, <code class="docutils literal notranslate"><span class="pre">WARNING</span></code>, indicators at the beginning
of each line. If the run has not been successful, you will see an <code class="docutils literal notranslate"><span class="pre">ERROR</span></code>
indicator and the execution will stop.</p>
<p>Please pay attention to the lines with a <code class="docutils literal notranslate"><span class="pre">WARNING</span></code>, try to understand their
meaning and whether if it is something that you expected from the execution or
not. If you do not understand its meaning or it was expected, there might be
something fishy about your input data or your configuration file.</p>
<p>Here’s an example of a <code class="docutils literal notranslate"><span class="pre">WARNING</span></code> message in the log:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INFO</span>    <span class="p">:</span> <span class="n">Step</span> <span class="mi">4</span> <span class="o">-</span> <span class="n">Load</span> <span class="n">LSK</span><span class="p">,</span> <span class="n">PCK</span><span class="p">,</span> <span class="n">FK</span> <span class="ow">and</span> <span class="n">SCLK</span> <span class="n">kernels</span>
<span class="n">INFO</span>    <span class="p">:</span> <span class="o">-------------------------------------------</span>
<span class="n">INFO</span>    <span class="p">:</span>
<span class="n">INFO</span>    <span class="p">:</span> <span class="o">--</span> <span class="n">LSK</span>     <span class="n">loaded</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;/kernels/lsk/naif0012.tls&#39;</span><span class="p">]</span>
<span class="n">WARNING</span> <span class="p">:</span> <span class="o">--</span> <span class="n">FK</span> <span class="ow">not</span> <span class="n">found</span><span class="o">.</span>
<span class="n">INFO</span>    <span class="p">:</span> <span class="o">--</span> <span class="n">SCLK</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">loaded</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;/kernels/sclk/NSY_SCLKSCET.00019.tsc&#39;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="what-if-something-goes-wrong">
<h2>What if something goes wrong?<a class="headerlink" href="#what-if-something-goes-wrong" title="Link to this heading"></a></h2>
<p>You’re covered. NPB has an argument: <code class="docutils literal notranslate"><span class="pre">-c</span> <span class="pre">CLEAR</span> <span class="pre">--clear</span> <span class="pre">CLEAR</span></code>, that allows you
to clear the resulting products of a run from your workspace.</p>
<p>After you run NPB (successfully or not) one of the by-products that NPB
generates is the <strong>File List</strong>. This File List is the value that is provided to
this argument. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ naif-pds4-bundler maven_release_26.xml -p working/maven_release_26.plan -c working/maven_release_26.file_list -v
</pre></div>
</div>
<p>By default, using this argument will stop the execution when the workspace
has been cleared.</p>
</section>
<section id="processing-large-binary-kernels">
<h2>Processing large binary kernels<a class="headerlink" href="#processing-large-binary-kernels" title="Link to this heading"></a></h2>
<p>When working with large binary kernels (CKs, SPKs, DSKs or PCKs) obtaining
the md5 sum hash (checksum, required by the products’ labels) of each file can
take a large amount of time. In order to avoid re-calculating
checksums NPB can be instructed to look for the <strong>checksum registry file(s)</strong>
in the <code class="docutils literal notranslate"><span class="pre">working_directory</span></code>, these files are automatically generated by NPB based on
the checksums that it calculates during its execution, they have <code class="docutils literal notranslate"><span class="pre">*.checksum</span></code>
extension, e.g., <code class="docutils literal notranslate"><span class="pre">maven_release_26.checksum</span></code>. In order to instruct NPB to use
these checksums you need to use the argument <code class="docutils literal notranslate"><span class="pre">-s</span> <span class="pre">--checksum</span></code>.</p>
<p>Note that NPB will use all the checksum registry files available in the
<code class="docutils literal notranslate"><span class="pre">working_directory</span></code>.</p>
<p>If the argument is provided but the file is not present, NPB will look in the
<code class="docutils literal notranslate"><span class="pre">staging_directory</span></code> for labels generated in previous runs and extract the
checksum from them.</p>
<p>We know from experience that this feature can save you a lot of time, but at
the same time it must be managed carefully and you must always be aware
whether the checksum registry files in the working directory and/or the
labeled products in the staging area are adequate.</p>
</section>
<section id="until-you-get-it-right">
<h2>Until you get it right<a class="headerlink" href="#until-you-get-it-right" title="Link to this heading"></a></h2>
<p>It is hard to get NPB to work on the first try, especially for the first
release of the archive or after a major update of the configuration file. Most
likely you will need to try several times before you get it right. That is why
we do not recommend you to set the <code class="docutils literal notranslate"><span class="pre">bundle_directory</span></code> to the final destination
of the archive but rather an intermediate destination before pushing the
incremented archive to the public (or to the relevant organization.)</p>
<p>A good idea is to stop NPB’s execution before the generated files are copied
from the staging directory to the bundle directory. You can do so by setting
the argument: <code class="docutils literal notranslate"><span class="pre">-f</span> <span class="pre">FAUCET</span> <span class="pre">--faucet</span> <span class="pre">FAUCET</span></code> to <code class="docutils literal notranslate"><span class="pre">staging</span></code>. More information
about this argument is provided in the section
<a class="reference internal" href="43_using_npb.html#optional-arguments-description"><span class="std std-ref">Optional Arguments Description</span></a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="32_step_2_npb_setup.html" class="btn btn-neutral float-left" title="Step 2: Preparing the NAIF PDS4 Bundler Setup" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="34_step_4_checking_the_result.html" class="btn btn-neutral float-right" title="Step 4: Checking the Result and Finishing Up" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Caltech/JPL/NASA.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q1K210DS5W"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-Q1K210DS5W', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>